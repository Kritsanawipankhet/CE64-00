<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script type="text/javascript" src="node_modules/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="node_modules/web3/dist/web3.min.js"></script>
    <script type="text/javascript" src="node_modules/truffle-contract/dist/truffle-contract.min.js"></script>
</head>

<body>
    <button id="btn-action">Perform Action</button>
    <script>
        $(document).ready(function () {
            //console.log("ready!");
            var web3;
            if (typeof web3 !== 'undefined') {

                web3js = new Web3(web3.currentProvider);
            } else {
                web3js = new Web3(new Web3.providers.HttpProvider('http://localhost:9545'));
                //console.log(web3js)
            }

            var contractAddress = "0xBF21D8f8ce30A76Ea3f9c1620D6E780fAD06bEd8";
            var contractABI = [
                {
                    "inputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "constructor"
                },
                {
                    "constant": true,
                    "inputs": [],
                    "name": "getName",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "",
                            "type": "string"
                        }
                    ],
                    "payable": false,
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "constant": false,
                    "inputs": [
                        {
                            "internalType": "string",
                            "name": "_name",
                            "type": "string"
                        }
                    ],
                    "name": "setName",
                    "outputs": [],
                    "payable": false,
                    "stateMutability": "nonpayable",
                    "type": "function"
                }
            ];
            contract = new web3js.eth.Contract(contractABI, contractAddress, {
                from: '0xA2b1e3779dC57Dbc22d9C768559d02dDbBE903a1', // default from address
                gasPrice: '20000000000' // default gas price in wei, 20 gwei in this case
            });
            web3js.eth.defaultAccount = '0xA2b1e3779dC57Dbc22d9C768559d02dDbBE903a1';
            // var result = contract.methods.getName().call();
            // console.log(result);
            web3js.eth.getAccounts(function (error, accounts) {
                console.log(accounts);
            })
            // contract.methods.getName().call({ from: '0xA2b1e3779dC57Dbc22d9C768559d02dDbBE903a1' }, function (error, result) {
            //     console.log(result, error);
            // });

            // contract.methods.getName().call({ from: '0xA2b1e3779dC57Dbc22d9C768559d02dDbBE903a1', gasPrice: 1000, value: 50 }).then(function (result) {

            // })
            async function setName() {
                const name = await contract.methods.setName('Wipankhet').send({ from: '0xA2b1e3779dC57Dbc22d9C768559d02dDbBE903a1' });
                console.log(name);
            }

            $('#btn-action').on('click', async (event) => {
                await setName();
            });
        });
    </script>
</body>

</html>