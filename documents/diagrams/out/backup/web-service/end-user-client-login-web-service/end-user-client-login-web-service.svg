<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1583px" preserveAspectRatio="none" style="width:1273px;height:1583px;background:#FFFFFF;" version="1.1" viewBox="0 0 1273 1583" width="1273px" zoomAndPan="magnify"><defs><filter height="300%" id="f1itpylfz7l9to" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="59.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="43.5" y="524.7227"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="75.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="140.5" y="119.7988"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="434.5" y="195.041"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="434.5" y="391.2148"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="59.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="434.5" y="464.791"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="882.2715" style="stroke:#A80036;stroke-width:1.0;" width="10" x="434.5" y="584.6543"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="44.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="439.5" y="768.5176"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="439.5" y="1016.957"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="439.5" y="1289.752"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="240.4395" style="stroke:#A80036;stroke-width:1.0;" width="10" x="822.5" y="224.3516"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="402.9922" style="stroke:#A80036;stroke-width:1.0;" width="10" x="822.5" y="613.9648"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="827.5" y="651.2754"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="827.5" y="924.0254"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="243.4844" style="stroke:#A80036;stroke-width:1.0;" width="10" x="822.5" y="1046.2676"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="827.5" y="1196.8203"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="87.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="822.5" y="1319.0625"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="308.2832"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="685.5859"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="857.4043"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="958.3359"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="1130.1992"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="1231.1309"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="1348.373"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="1129.332" style="stroke:#000000;stroke-width:2.0;" width="1249" x="10" y="352.5938"/><rect fill="#FFFFFF" height="1053.4004" style="stroke:none;stroke-width:1.0;" width="1249" x="10" y="428.5254"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="745.0293" style="stroke:#000000;stroke-width:2.0;" width="1229" x="20" y="729.8965"/><rect fill="#FFFFFF" height="653.7871" style="stroke:none;stroke-width:1.0;" width="1229" x="20" y="821.1387"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="48" x2="48" y1="88.4883" y2="1498.9258"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="145.5" x2="145.5" y1="88.4883" y2="1498.9258"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="439" x2="439" y1="88.4883" y2="1498.9258"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="827.5" x2="827.5" y1="88.4883" y2="1498.9258"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1193" x2="1193" y1="88.4883" y2="1498.9258"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="30" y="85.5352">User</text><ellipse cx="48.5" cy="15" fill="#FEFECE" filter="url(#f1itpylfz7l9to)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M48.5,23 L48.5,50 M35.5,31 L61.5,31 M48.5,50 L35.5,65 M48.5,50 L61.5,65 " fill="none" filter="url(#f1itpylfz7l9to)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="30" y="1511.4609">User</text><ellipse cx="48.5" cy="1524.4141" fill="#FEFECE" filter="url(#f1itpylfz7l9to)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M48.5,1532.4141 L48.5,1559.4141 M35.5,1540.4141 L61.5,1540.4141 M48.5,1559.4141 L35.5,1574.4141 M48.5,1559.4141 L61.5,1574.4141 " fill="none" filter="url(#f1itpylfz7l9to)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#f1itpylfz7l9to)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="54" x="116.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="123.5" y="73.5352">Client</text><rect fill="#FEFECE" filter="url(#f1itpylfz7l9to)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="54" x="116.5" y="1497.9258"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="123.5" y="1518.4609">Client</text><rect fill="#FEFECE" filter="url(#f1itpylfz7l9to)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="95" x="390" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="397" y="73.5352">Web Service</text><rect fill="#FEFECE" filter="url(#f1itpylfz7l9to)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="95" x="390" y="1497.9258"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="397" y="1518.4609">Web Service</text><rect fill="#FEFECE" filter="url(#f1itpylfz7l9to)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="156" x="747.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="754.5" y="73.5352">Authorization Server</text><rect fill="#FEFECE" filter="url(#f1itpylfz7l9to)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="156" x="747.5" y="1497.9258"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="754.5" y="1518.4609">Authorization Server</text><rect fill="#FEFECE" filter="url(#f1itpylfz7l9to)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="1148" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="1155" y="73.5352">Blockchain</text><rect fill="#FEFECE" filter="url(#f1itpylfz7l9to)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="1148" y="1497.9258"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="1155" y="1518.4609">Blockchain</text><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="59.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="43.5" y="524.7227"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="75.2422" style="stroke:#A80036;stroke-width:1.0;" width="10" x="140.5" y="119.7988"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="434.5" y="195.041"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="434.5" y="391.2148"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="59.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="434.5" y="464.791"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="882.2715" style="stroke:#A80036;stroke-width:1.0;" width="10" x="434.5" y="584.6543"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="44.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="439.5" y="768.5176"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="439.5" y="1016.957"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="439.5" y="1289.752"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="240.4395" style="stroke:#A80036;stroke-width:1.0;" width="10" x="822.5" y="224.3516"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="402.9922" style="stroke:#A80036;stroke-width:1.0;" width="10" x="822.5" y="613.9648"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="827.5" y="651.2754"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="827.5" y="924.0254"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="243.4844" style="stroke:#A80036;stroke-width:1.0;" width="10" x="822.5" y="1046.2676"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="827.5" y="1196.8203"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="87.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="822.5" y="1319.0625"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="308.2832"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="685.5859"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="857.4043"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="958.3359"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="1130.1992"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="1231.1309"/><rect fill="#FFFFFF" filter="url(#f1itpylfz7l9to)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1188.5" y="1348.373"/><polygon fill="#A80036" points="128.5,115.7988,138.5,119.7988,128.5,123.7988,132.5,119.7988" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48.5" x2="134.5" y1="119.7988" y2="119.7988"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55.5" y="115.0566">(1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50" x="78.5" y="115.0566">Request</text><polygon fill="#A80036" points="422.5,191.041,432.5,195.041,422.5,199.041,426.5,195.041" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="145.5" x2="428.5" y1="195.041" y2="195.041"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="152.5" y="167.333">(2)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="175.5" y="144.3672">Redirect to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="175.5" y="159.6777">https://[Authorization Server]/oauth/?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="175.5" y="174.9883">[client_id,redirect_uri,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="175.5" y="190.2988">response_type,grant_type]</text><polygon fill="#A80036" points="810.5,220.3516,820.5,224.3516,810.5,228.3516,814.5,224.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="439.5" x2="816.5" y1="224.3516" y2="224.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="446.5" y="219.6094">(3)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="469.5" y="219.6094">Verification client credentials</text><path d="M726,237.3516 L726,277.3516 L924,277.3516 L924,247.3516 L914,237.3516 L726,237.3516 " fill="#FBFB77" filter="url(#f1itpylfz7l9to)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M914,237.3516 L914,247.3516 L924,247.3516 L914,237.3516 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177" x="732" y="254.9199">Needs client_id,redirect_uri,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="732" y="270.2305">response_type=code</text><polygon fill="#A80036" points="1176.5,304.2832,1186.5,308.2832,1176.5,312.2832,1180.5,308.2832" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="1182.5" y1="308.2832" y2="308.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="839.5" y="303.541">(4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="862.5" y="303.541">Call Resource client credentials</text><polygon fill="#A80036" points="843.5,333.5938,833.5,337.5938,843.5,341.5938,839.5,337.5938" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="837.5" x2="1192.5" y1="337.5938" y2="337.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="849.5" y="332.8516">(5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="872.5" y="332.8516">Response client credentials</text><path d="M10,352.5938 L72,352.5938 L72,359.5938 L62,369.5938 L10,369.5938 L10,352.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1129.332" style="stroke:#000000;stroke-width:2.0;" width="1249" x="10" y="352.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="366.1621">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="141" x="87" y="365.2285">[Invalid client credential]</text><polygon fill="#A80036" points="455.5,387.2148,445.5,391.2148,455.5,395.2148,451.5,391.2148" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="449.5" x2="821.5" y1="391.2148" y2="391.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="461.5" y="386.4727">Authentication denied</text><polygon fill="#A80036" points="59.5,416.5254,49.5,420.5254,59.5,424.5254,55.5,420.5254" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53.5" x2="438.5" y1="420.5254" y2="420.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="65.5" y="415.7832">Redirect to Error Page</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1259" y1="429.5254" y2="429.5254"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="130" x="15" y="440.1602">[valid client credential]</text><polygon fill="#A80036" points="455.5,460.791,445.5,464.791,455.5,468.791,451.5,464.791" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="449.5" x2="826.5" y1="464.791" y2="464.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="461.5" y="460.0488">(6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172" x="484.5" y="460.0488">Response client credentials</text><polygon fill="#A80036" points="64.5,520.7227,54.5,524.7227,64.5,528.7227,60.5,524.7227" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="58.5" x2="438.5" y1="524.7227" y2="524.7227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="70.5" y="504.6699">(7)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="93.5" y="489.3594">Response Login Page</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214" x="93.5" y="504.6699">GET /oauth?[client_id,redirect_uri,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="93.5" y="519.9805">response_type,grant_type]</text><polygon fill="#A80036" points="422.5,580.6543,432.5,584.6543,422.5,588.6543,426.5,584.6543" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="48.5" x2="428.5" y1="584.6543" y2="584.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="55.5" y="564.6016">(8)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="78.5" y="549.291">Enter user credentials</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="78.5" y="564.6016">[email,password]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="78.5" y="579.9121">POST /oauth</text><polygon fill="#A80036" points="810.5,609.9648,820.5,613.9648,810.5,617.9648,814.5,613.9648" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="444.5" x2="816.5" y1="613.9648" y2="613.9648"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="451.5" y="609.2227">(9)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="474.5" y="609.2227">Request Authorization</text><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="879.5" y1="638.2754" y2="638.2754"/><line style="stroke:#A80036;stroke-width:1.0;" x1="879.5" x2="879.5" y1="638.2754" y2="651.2754"/><line style="stroke:#A80036;stroke-width:1.0;" x1="838.5" x2="879.5" y1="651.2754" y2="651.2754"/><polygon fill="#A80036" points="848.5,647.2754,838.5,651.2754,848.5,655.2754,844.5,651.2754" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="844.5" y="633.5332">(10)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="876.5" y="633.5332">Encrypt user credentials</text><polygon fill="#A80036" points="1176.5,681.5859,1186.5,685.5859,1176.5,689.5859,1180.5,685.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="1182.5" y1="685.5859" y2="685.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="839.5" y="680.8438">(11)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251" x="871.5" y="680.8438">Request user credentials for verification</text><polygon fill="#A80036" points="843.5,710.8965,833.5,714.8965,843.5,718.8965,839.5,714.8965" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="837.5" x2="1192.5" y1="714.8965" y2="714.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="849.5" y="710.1543">(12)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="881.5" y="710.1543">Response user data validity status</text><path d="M20,729.8965 L82,729.8965 L82,736.8965 L72,746.8965 L20,746.8965 L20,729.8965 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="745.0293" style="stroke:#000000;stroke-width:2.0;" width="1229" x="20" y="729.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="35" y="743.4648">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="179" x="97" y="742.5313">[Invalid user credentials (false)]</text><polygon fill="#A80036" points="460.5,764.5176,450.5,768.5176,460.5,772.5176,456.5,768.5176" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="454.5" x2="821.5" y1="768.5176" y2="768.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="466.5" y="763.7754">Authentication denied</text><polygon fill="#A80036" points="59.5,809.1387,49.5,813.1387,59.5,817.1387,55.5,813.1387" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53.5" x2="433.5" y1="813.1387" y2="813.1387"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="65.5" y="793.0859">Response notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="65.5" y="808.3965">"Username or Password Incorrect"</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="1249" y1="822.1387" y2="822.1387"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="163" x="25" y="832.7734">[valid user credentials (true)]</text><polygon fill="#A80036" points="1176.5,853.4043,1186.5,857.4043,1176.5,861.4043,1180.5,857.4043" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="1182.5" y1="857.4043" y2="857.4043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="839.5" y="852.6621">(13)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="871.5" y="852.6621">Call resource client credential</text><polygon fill="#A80036" points="843.5,882.7148,833.5,886.7148,843.5,890.7148,839.5,886.7148" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="837.5" x2="1192.5" y1="886.7148" y2="886.7148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="849.5" y="881.9727">(14)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="881.5" y="881.9727">Response resource client credential</text><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="879.5" y1="911.0254" y2="911.0254"/><line style="stroke:#A80036;stroke-width:1.0;" x1="879.5" x2="879.5" y1="911.0254" y2="924.0254"/><line style="stroke:#A80036;stroke-width:1.0;" x1="838.5" x2="879.5" y1="924.0254" y2="924.0254"/><polygon fill="#A80036" points="848.5,920.0254,838.5,924.0254,848.5,928.0254,844.5,924.0254" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="844.5" y="906.2832">(15)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="876.5" y="906.2832">Grant and Generate Authorization Code &amp; Encrypt</text><polygon fill="#A80036" points="1176.5,954.3359,1186.5,958.3359,1176.5,962.3359,1180.5,958.3359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="1182.5" y1="958.3359" y2="958.3359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="839.5" y="953.5938">(16)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="871.5" y="953.5938">Send authorization code credential</text><polygon fill="#A80036" points="843.5,983.6465,833.5,987.6465,843.5,991.6465,839.5,987.6465" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="837.5" x2="1192.5" y1="987.6465" y2="987.6465"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="849.5" y="982.9043">(17)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="881.5" y="982.9043">Response</text><polygon fill="#A80036" points="460.5,1012.957,450.5,1016.957,460.5,1020.957,456.5,1016.957" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="454.5" x2="826.5" y1="1016.957" y2="1016.957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="466.5" y="1012.2148">(18)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="498.5" y="1012.2148">Response Authorization Code</text><polygon fill="#A80036" points="810.5,1042.2676,820.5,1046.2676,810.5,1050.2676,814.5,1046.2676" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="444.5" x2="816.5" y1="1046.2676" y2="1046.2676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="451.5" y="1041.5254">(19)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295" x="483.5" y="1041.5254">Exchange authorization code for Access Token</text><path d="M688,1059.2676 L688,1099.2676 L963,1099.2676 L963,1069.2676 L953,1059.2676 L688,1059.2676 " fill="#FBFB77" filter="url(#f1itpylfz7l9to)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M953,1059.2676 L953,1069.2676 L963,1069.2676 L953,1059.2676 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254" x="694" y="1076.8359">Need client_id,client_secret,redirect_uri,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="694" y="1092.1465">grant_type=authorization_code</text><polygon fill="#A80036" points="1176.5,1126.1992,1186.5,1130.1992,1176.5,1134.1992,1180.5,1130.1992" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="1182.5" y1="1130.1992" y2="1130.1992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="839.5" y="1125.457">(20)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="871.5" y="1125.457">Call resource client credential</text><polygon fill="#A80036" points="843.5,1155.5098,833.5,1159.5098,843.5,1163.5098,839.5,1159.5098" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="837.5" x2="1192.5" y1="1159.5098" y2="1159.5098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="849.5" y="1154.7676">(21)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="881.5" y="1154.7676">Response resource client credential</text><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="879.5" y1="1183.8203" y2="1183.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="879.5" x2="879.5" y1="1183.8203" y2="1196.8203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="838.5" x2="879.5" y1="1196.8203" y2="1196.8203"/><polygon fill="#A80036" points="848.5,1192.8203,838.5,1196.8203,848.5,1200.8203,844.5,1196.8203" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="844.5" y="1179.0781">(22)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="876.5" y="1179.0781">Generate Access Token &amp; Encrypt</text><polygon fill="#A80036" points="1176.5,1227.1309,1186.5,1231.1309,1176.5,1235.1309,1180.5,1231.1309" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="1182.5" y1="1231.1309" y2="1231.1309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="839.5" y="1226.3887">(23)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="871.5" y="1226.3887">Send access token credential</text><polygon fill="#A80036" points="843.5,1256.4414,833.5,1260.4414,843.5,1264.4414,839.5,1260.4414" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="837.5" x2="1192.5" y1="1260.4414" y2="1260.4414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="849.5" y="1255.6992">(24)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="881.5" y="1255.6992">Response</text><polygon fill="#A80036" points="460.5,1285.752,450.5,1289.752,460.5,1293.752,456.5,1289.752" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="454.5" x2="826.5" y1="1289.752" y2="1289.752"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="466.5" y="1285.0098">(25)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="498.5" y="1285.0098">Response access token credential</text><polygon fill="#A80036" points="810.5,1315.0625,820.5,1319.0625,810.5,1323.0625,814.5,1319.0625" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="444.5" x2="816.5" y1="1319.0625" y2="1319.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="451.5" y="1314.3203">(26)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="483.5" y="1314.3203">Call resource user with Access Token</text><polygon fill="#A80036" points="1176.5,1344.373,1186.5,1348.373,1176.5,1352.373,1180.5,1348.373" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="832.5" x2="1182.5" y1="1348.373" y2="1348.373"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="839.5" y="1343.6309">(27)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="871.5" y="1343.6309">Call resource user credential</text><polygon fill="#A80036" points="843.5,1373.6836,833.5,1377.6836,843.5,1381.6836,839.5,1377.6836" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="837.5" x2="1192.5" y1="1377.6836" y2="1377.6836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="849.5" y="1372.9414">(28)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="881.5" y="1372.9414">Response user credential</text><polygon fill="#A80036" points="455.5,1402.9941,445.5,1406.9941,455.5,1410.9941,451.5,1406.9941" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="449.5" x2="826.5" y1="1406.9941" y2="1406.9941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="461.5" y="1402.252">(29)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322" x="493.5" y="1402.252">Response user credential &amp; access token credential</text><polygon fill="#A80036" points="59.5,1462.9258,49.5,1466.9258,59.5,1470.9258,55.5,1466.9258" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="53.5" x2="438.5" y1="1466.9258" y2="1466.9258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="65.5" y="1446.873">(30)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68" x="97.5" y="1431.5625">Redirect to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="97.5" y="1446.873">POST https://[redirect_uri]/callback?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213" x="97.5" y="1462.1836">[token_credential,user_credential]</text><!--MD5=[0188b75b859626e184959bfd0c1c092b]
@startuml
actor User
autonumber "<b>(0)"
"User" -> "Client" ++: Request 
"Client" -> "Web Service" - -++: Redirect to\nhttps://[Authorization Server]/oauth/?\n[client_id,redirect_uri,\nresponse_type,grant_type]
"Web Service" -> "Authorization Server" - -++: Verification client credentials
note over "Authorization Server": Needs client_id,redirect_uri,\nresponse_type=code
"Authorization Server" -> "Blockchain" ++: Call Resource client credentials
"Blockchain" -> "Authorization Server" - -: Response client credentials
alt Invalid client credential
    autonumber stop
    "Authorization Server" - -> "Web Service" ++: Authentication denied
    "Web Service" - -> "User" - -: Redirect to Error Page 
else valid client credential
    autonumber resume
    "Authorization Server" - -> "Web Service" - -++: Response client credentials
    "Web Service" - -> "User" - -++: Response Login Page\nGET /oauth?[client_id,redirect_uri,\nresponse_type,grant_type]
    "User" -> "Web Service" - -++: Enter user credentials\n[email,password]\nPOST /oauth
    "Web Service" -> "Authorization Server" ++: Request Authorization
    "Authorization Server" -> "Authorization Server" ++: Encrypt user credentials
    "Authorization Server" -> "Blockchain" - -++: Request user credentials for verification
    "Blockchain" - -> "Authorization Server" - -: Response user data validity status
    alt Invalid user credentials (false)
        autonumber stop
        "Authorization Server" - -> "Web Service" ++: Authentication denied
        "Web Service" - -> "User" - -: Response notification\n"Username or Password Incorrect"
    else valid user credentials (true)
        autonumber resume
        "Authorization Server" -> "Blockchain" ++: Call resource client credential
        "Blockchain" - -> "Authorization Server" - -: Response resource client credential
        "Authorization Server" -> "Authorization Server" ++: Grant and Generate Authorization Code & Encrypt
        "Authorization Server" -> "Blockchain" - -++: Send authorization code credential
        "Blockchain" - -> "Authorization Server" - -: Response 
        "Authorization Server" - -> "Web Service" - -++: Response Authorization Code
        "Web Service" -> "Authorization Server" - -++: Exchange authorization code for Access Token
        note over "Authorization Server": Need client_id,client_secret,redirect_uri,\ngrant_type=authorization_code
        "Authorization Server" -> "Blockchain" ++: Call resource client credential
        "Blockchain" - -> "Authorization Server" - -: Response resource client credential
        "Authorization Server" -> "Authorization Server" ++: Generate Access Token & Encrypt
        "Authorization Server" -> "Blockchain" - -++: Send access token credential
        "Blockchain" - -> "Authorization Server" - -: Response 
        "Authorization Server" - -> "Web Service" - -++: Response access token credential
        "Web Service" -> "Authorization Server" - -++: Call resource user with Access Token
        "Authorization Server" -> "Blockchain" ++: Call resource user credential
        "Blockchain" - -> "Authorization Server" - -: Response user credential
        "Authorization Server" - -> "Web Service" - -: Response user credential & access token credential
        "Web Service" - -> "User" - -: Redirect to \nPOST https://[redirect_uri]/callback?\n[token_credential,user_credential]
    end
end



@enduml

PlantUML version 1.2022.0(Tue Jan 11 23:16:42 ICT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: TH
--></g></svg>