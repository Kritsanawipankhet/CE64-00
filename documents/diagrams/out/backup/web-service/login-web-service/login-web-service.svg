<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1301px" preserveAspectRatio="none" style="width:1096px;height:1301px;background:#FFFFFF;" version="1.1" viewBox="0 0 1096 1301" width="1096px" zoomAndPan="magnify"><defs><filter height="300%" id="fgi8rutzboco4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="59.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="33.5" y="179.7305"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="44.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="274.5" y="135.1094"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="952.2031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="274.5" y="239.6621"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="44.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="279.5" y="493.457"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="279.5" y="741.8965"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="279.5" y="1030.002"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="472.9238" style="stroke:#A80036;stroke-width:1.0;" width="10" x="655.5" y="268.9727"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="660.5" y="376.2148"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="660.5" y="648.9648"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="258.7949" style="stroke:#A80036;stroke-width:1.0;" width="10" x="655.5" y="771.207"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="660.5" y="937.0703"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="87.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="655.5" y="1059.3125"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="410.5254"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="582.3438"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="683.2754"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="870.4492"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="971.3809"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="1088.623"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="745.0293" style="stroke:#000000;stroke-width:2.0;" width="1072" x="10" y="454.8359"/><rect fill="#FFFFFF" height="653.7871" style="stroke:none;stroke-width:1.0;" width="1072" x="10" y="546.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="88.4883" y2="1216.8652"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="279" x2="279" y1="88.4883" y2="1216.8652"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="660.5" x2="660.5" y1="88.4883" y2="1216.8652"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1026" x2="1026" y1="88.4883" y2="1216.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="20" y="85.5352">User</text><ellipse cx="38.5" cy="15" fill="#FEFECE" filter="url(#fgi8rutzboco4)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M38.5,23 L38.5,50 M25.5,31 L51.5,31 M38.5,50 L25.5,65 M38.5,50 L51.5,65 " fill="none" filter="url(#fgi8rutzboco4)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="20" y="1229.4004">User</text><ellipse cx="38.5" cy="1242.3535" fill="#FEFECE" filter="url(#fgi8rutzboco4)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M38.5,1250.3535 L38.5,1277.3535 M25.5,1258.3535 L51.5,1258.3535 M38.5,1277.3535 L25.5,1292.3535 M38.5,1277.3535 L51.5,1292.3535 " fill="none" filter="url(#fgi8rutzboco4)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fgi8rutzboco4)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="95" x="230" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="237" y="73.5352">Web Service</text><rect fill="#FEFECE" filter="url(#fgi8rutzboco4)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="95" x="230" y="1215.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="237" y="1236.4004">Web Service</text><rect fill="#FEFECE" filter="url(#fgi8rutzboco4)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="156" x="580.5" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="587.5" y="73.5352">Authorization Server</text><rect fill="#FEFECE" filter="url(#fgi8rutzboco4)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="156" x="580.5" y="1215.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142" x="587.5" y="1236.4004">Authorization Server</text><rect fill="#FEFECE" filter="url(#fgi8rutzboco4)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="981" y="53"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="988" y="73.5352">Blockchain</text><rect fill="#FEFECE" filter="url(#fgi8rutzboco4)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="87" x="981" y="1215.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="988" y="1236.4004">Blockchain</text><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="59.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="33.5" y="179.7305"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="44.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="274.5" y="135.1094"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="952.2031" style="stroke:#A80036;stroke-width:1.0;" width="10" x="274.5" y="239.6621"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="44.6211" style="stroke:#A80036;stroke-width:1.0;" width="10" x="279.5" y="493.457"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="279.5" y="741.8965"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="279.5" y="1030.002"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="472.9238" style="stroke:#A80036;stroke-width:1.0;" width="10" x="655.5" y="268.9727"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="660.5" y="376.2148"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="660.5" y="648.9648"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="258.7949" style="stroke:#A80036;stroke-width:1.0;" width="10" x="655.5" y="771.207"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="34.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="660.5" y="937.0703"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="87.9316" style="stroke:#A80036;stroke-width:1.0;" width="10" x="655.5" y="1059.3125"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="410.5254"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="582.3438"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="683.2754"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="870.4492"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="971.3809"/><rect fill="#FFFFFF" filter="url(#fgi8rutzboco4)" height="29.3105" style="stroke:#A80036;stroke-width:1.0;" width="10" x="1021.5" y="1088.623"/><polygon fill="#A80036" points="262.5,131.1094,272.5,135.1094,262.5,139.1094,266.5,135.1094" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="38.5" x2="268.5" y1="135.1094" y2="135.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45.5" y="122.7119">(1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="68.5" y="115.0566">Request Login Page</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="68.5" y="130.3672">GET /oauth</text><polygon fill="#A80036" points="54.5,175.7305,44.5,179.7305,54.5,183.7305,50.5,179.7305" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="48.5" x2="278.5" y1="179.7305" y2="179.7305"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="60.5" y="167.333">(2)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="83.5" y="159.6777">Reponse Login Page Content</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71" x="83.5" y="174.9883">GET /oauth</text><polygon fill="#A80036" points="262.5,235.6621,272.5,239.6621,262.5,243.6621,266.5,239.6621" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="38.5" x2="268.5" y1="239.6621" y2="239.6621"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="45.5" y="219.6094">(3)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="68.5" y="204.2988">Enter user credentials</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="68.5" y="219.6094">[email,password]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79" x="68.5" y="234.9199">POST /oauth</text><polygon fill="#A80036" points="643.5,264.9727,653.5,268.9727,643.5,272.9727,647.5,268.9727" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="284.5" x2="649.5" y1="268.9727" y2="268.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="291.5" y="264.2305">(4)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="314.5" y="264.2305">Request Authorization</text><path d="M569,281.9727 L569,336.9727 L747,336.9727 L747,291.9727 L737,281.9727 L569,281.9727 " fill="#FBFB77" filter="url(#fgi8rutzboco4)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M737,281.9727 L737,291.9727 L747,291.9727 L737,281.9727 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="575" y="299.541">Set client_id,redirect_uri,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="575" y="314.8516">response_type=code</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="575" y="330.1621">for web service itself</text><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="712.5" y1="363.2148" y2="363.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="712.5" x2="712.5" y1="363.2148" y2="376.2148"/><line style="stroke:#A80036;stroke-width:1.0;" x1="671.5" x2="712.5" y1="376.2148" y2="376.2148"/><polygon fill="#A80036" points="681.5,372.2148,671.5,376.2148,681.5,380.2148,677.5,376.2148" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="677.5" y="358.4727">(5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151" x="700.5" y="358.4727">Encrypt user credentials</text><polygon fill="#A80036" points="1009.5,406.5254,1019.5,410.5254,1009.5,414.5254,1013.5,410.5254" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="1015.5" y1="410.5254" y2="410.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="672.5" y="405.7832">(6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251" x="695.5" y="405.7832">Request user credentials for verification</text><polygon fill="#A80036" points="676.5,435.8359,666.5,439.8359,676.5,443.8359,672.5,439.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="670.5" x2="1025.5" y1="439.8359" y2="439.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="682.5" y="435.0938">(7)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="705.5" y="435.0938">Response user data validity status</text><path d="M10,454.8359 L72,454.8359 L72,461.8359 L62,471.8359 L10,471.8359 L10,454.8359 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="745.0293" style="stroke:#000000;stroke-width:2.0;" width="1072" x="10" y="454.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="25" y="468.4043">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="179" x="87" y="467.4707">[Invalid user credentials (false)]</text><polygon fill="#A80036" points="300.5,489.457,290.5,493.457,300.5,497.457,296.5,493.457" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="294.5" x2="654.5" y1="493.457" y2="493.457"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="306.5" y="488.7148">Authentication denied</text><polygon fill="#A80036" points="49.5,534.0781,39.5,538.0781,49.5,542.0781,45.5,538.0781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="273.5" y1="538.0781" y2="538.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="55.5" y="518.0254">Response notification</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="55.5" y="533.3359">"Username or Password Incorrect"</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1082" y1="547.0781" y2="547.0781"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="163" x="15" y="557.7129">[valid user credentials (true)]</text><polygon fill="#A80036" points="1009.5,578.3438,1019.5,582.3438,1009.5,586.3438,1013.5,582.3438" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="1015.5" y1="582.3438" y2="582.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="672.5" y="577.6016">(8)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="695.5" y="577.6016">Call resource client credential</text><polygon fill="#A80036" points="676.5,607.6543,666.5,611.6543,676.5,615.6543,672.5,611.6543" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="670.5" x2="1025.5" y1="611.6543" y2="611.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="682.5" y="606.9121">(9)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="705.5" y="606.9121">Response resource client credential</text><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="712.5" y1="635.9648" y2="635.9648"/><line style="stroke:#A80036;stroke-width:1.0;" x1="712.5" x2="712.5" y1="635.9648" y2="648.9648"/><line style="stroke:#A80036;stroke-width:1.0;" x1="671.5" x2="712.5" y1="648.9648" y2="648.9648"/><polygon fill="#A80036" points="681.5,644.9648,671.5,648.9648,681.5,652.9648,677.5,648.9648" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="677.5" y="631.2227">(10)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310" x="709.5" y="631.2227">Grant and Generate Authorization Code &amp; Encrypt</text><polygon fill="#A80036" points="1009.5,679.2754,1019.5,683.2754,1009.5,687.2754,1013.5,683.2754" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="1015.5" y1="683.2754" y2="683.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="672.5" y="678.5332">(11)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218" x="704.5" y="678.5332">Send authorization code credential</text><polygon fill="#A80036" points="676.5,708.5859,666.5,712.5859,676.5,716.5859,672.5,712.5859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="670.5" x2="1025.5" y1="712.5859" y2="712.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="682.5" y="707.8438">(12)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="714.5" y="707.8438">Response</text><polygon fill="#A80036" points="300.5,737.8965,290.5,741.8965,300.5,745.8965,296.5,741.8965" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="294.5" x2="659.5" y1="741.8965" y2="741.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="306.5" y="737.1543">(13)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186" x="338.5" y="737.1543">Response Authorization Code</text><polygon fill="#A80036" points="643.5,767.207,653.5,771.207,643.5,775.207,647.5,771.207" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="284.5" x2="649.5" y1="771.207" y2="771.207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="291.5" y="766.4648">(14)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295" x="323.5" y="766.4648">Exchange authorization code for Access Token</text><path d="M527,784.207 L527,839.207 L789,839.207 L789,794.207 L779,784.207 L527,784.207 " fill="#FBFB77" filter="url(#fgi8rutzboco4)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M779,784.207 L779,794.207 L789,794.207 L779,784.207 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="533" y="801.7754">set client_id,client_secret,redirect_uri,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="533" y="817.0859">grant_type=authorization_code</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="533" y="832.3965">for web service itself</text><polygon fill="#A80036" points="1009.5,866.4492,1019.5,870.4492,1009.5,874.4492,1013.5,870.4492" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="1015.5" y1="870.4492" y2="870.4492"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="672.5" y="865.707">(15)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="704.5" y="865.707">Call resource client credential</text><polygon fill="#A80036" points="676.5,895.7598,666.5,899.7598,676.5,903.7598,672.5,899.7598" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="670.5" x2="1025.5" y1="899.7598" y2="899.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="682.5" y="895.0176">(16)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223" x="714.5" y="895.0176">Response resource client credential</text><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="712.5" y1="924.0703" y2="924.0703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="712.5" x2="712.5" y1="924.0703" y2="937.0703"/><line style="stroke:#A80036;stroke-width:1.0;" x1="671.5" x2="712.5" y1="937.0703" y2="937.0703"/><polygon fill="#A80036" points="681.5,933.0703,671.5,937.0703,681.5,941.0703,677.5,937.0703" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="677.5" y="919.3281">(17)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="709.5" y="919.3281">Generate Access Token &amp; Encrypt</text><polygon fill="#A80036" points="1009.5,967.3809,1019.5,971.3809,1009.5,975.3809,1013.5,971.3809" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="1015.5" y1="971.3809" y2="971.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="672.5" y="966.6387">(18)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="704.5" y="966.6387">Send access token credential</text><polygon fill="#A80036" points="676.5,996.6914,666.5,1000.6914,676.5,1004.6914,672.5,1000.6914" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="670.5" x2="1025.5" y1="1000.6914" y2="1000.6914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="682.5" y="995.9492">(19)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="714.5" y="995.9492">Response</text><polygon fill="#A80036" points="300.5,1026.002,290.5,1030.002,300.5,1034.002,296.5,1030.002" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="294.5" x2="659.5" y1="1030.002" y2="1030.002"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="306.5" y="1025.2598">(20)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="338.5" y="1025.2598">Response access token credential</text><polygon fill="#A80036" points="643.5,1055.3125,653.5,1059.3125,643.5,1063.3125,647.5,1059.3125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="284.5" x2="649.5" y1="1059.3125" y2="1059.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="291.5" y="1054.5703">(21)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="323.5" y="1054.5703">Call resource user with Access Token</text><polygon fill="#A80036" points="1009.5,1084.623,1019.5,1088.623,1009.5,1092.623,1013.5,1088.623" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="665.5" x2="1015.5" y1="1088.623" y2="1088.623"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="672.5" y="1083.8809">(22)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="704.5" y="1083.8809">Call resource user credential</text><polygon fill="#A80036" points="676.5,1113.9336,666.5,1117.9336,676.5,1121.9336,672.5,1117.9336" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="670.5" x2="1025.5" y1="1117.9336" y2="1117.9336"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="682.5" y="1113.1914">(23)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="157" x="714.5" y="1113.1914">Response user credential</text><polygon fill="#A80036" points="295.5,1143.2441,285.5,1147.2441,295.5,1151.2441,291.5,1147.2441" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="289.5" x2="659.5" y1="1147.2441" y2="1147.2441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="301.5" y="1142.502">(24)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315" x="333.5" y="1142.502">Set Cookie-based=[access_token,user_credential]</text><polygon fill="#A80036" points="49.5,1187.8652,39.5,1191.8652,49.5,1195.8652,45.5,1191.8652" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="278.5" y1="1191.8652" y2="1191.8652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="55.5" y="1179.4678">(25)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="87.5" y="1171.8125">Redirect to Page</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="87.5" y="1187.123">GET /[redirect_uri]</text><!--MD5=[4c4509ec5ee3813fd52738e343a3b9ea]
@startuml
actor User
autonumber "<b>(0)"
"User" -> "Web Service" ++: Request Login Page \nGET /oauth
"Web Service" - -> "User" - -++: Reponse Login Page Content\nGET /oauth
"User" -> "Web Service" - -++: Enter user credentials\n[email,password]\nPOST /oauth
"Web Service" -> "Authorization Server" ++: Request Authorization
note over "Authorization Server": Set client_id,redirect_uri,\nresponse_type=code\nfor web service itself
"Authorization Server" -> "Authorization Server" ++: Encrypt user credentials
"Authorization Server" -> "Blockchain" - -++: Request user credentials for verification
"Blockchain" - -> "Authorization Server" - -: Response user data validity status
alt Invalid user credentials (false)
    autonumber stop
    "Authorization Server" - -> "Web Service" ++: Authentication denied
    "Web Service" - -> "User" - -: Response notification\n"Username or Password Incorrect"
else valid user credentials (true)
    autonumber resume
    "Authorization Server" -> "Blockchain" ++: Call resource client credential
    "Blockchain" - -> "Authorization Server" - -: Response resource client credential
    "Authorization Server" -> "Authorization Server" ++: Grant and Generate Authorization Code & Encrypt
    "Authorization Server" -> "Blockchain" - -++: Send authorization code credential
    "Blockchain" - -> "Authorization Server" - -: Response 
    "Authorization Server" - -> "Web Service" - -++: Response Authorization Code
    "Web Service" -> "Authorization Server" - -++: Exchange authorization code for Access Token
    note over "Authorization Server": set client_id,client_secret,redirect_uri,\ngrant_type=authorization_code\nfor web service itself
    "Authorization Server" -> "Blockchain" ++: Call resource client credential
    "Blockchain" - -> "Authorization Server" - -: Response resource client credential
    "Authorization Server" -> "Authorization Server" ++: Generate Access Token & Encrypt
    "Authorization Server" -> "Blockchain" - -++: Send access token credential
    "Blockchain" - -> "Authorization Server" - -: Response 
    "Authorization Server" - -> "Web Service" - -++: Response access token credential
    "Web Service" -> "Authorization Server" - -++: Call resource user with Access Token
    "Authorization Server" -> "Blockchain" ++: Call resource user credential
    "Blockchain" - -> "Authorization Server" - -: Response user credential
    "Authorization Server" - -> "Web Service" - -: Set Cookie-based=[access_token,user_credential]
    "Web Service" - -> "User" - -: Redirect to Page\nGET /[redirect_uri]
end


@enduml

PlantUML version 1.2022.0(Tue Jan 11 23:16:42 ICT 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: TH
--></g></svg>